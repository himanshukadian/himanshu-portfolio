"use strict";(self.webpackChunkblog_app=self.webpackChunkblog_app||[]).push([[360],{1438:(e,s,n)=>{n.d(s,{A:()=>C});var r=n(5043),t=n(8387),a=n(3129),i=n(6061),o=n(1807),l=n(883),d=n(8480),c=n(4265);var u=n(5227),m=n(9049),p=n(6167),h=n(1834),x=n(579);const A=(0,m.A)(),f=(0,l.A)("div",{name:"MuiStack",slot:"Root"});function y(e){return function(e){let{props:s,name:n,defaultTheme:r,themeId:t}=e,a=(0,c.A)(r);return t&&(a=a[t]||a),(0,d.A)({theme:a,name:n,props:s})}({props:e,name:"MuiStack",defaultTheme:A})}function j(e,s){const n=r.Children.toArray(e).filter(Boolean);return n.reduce(((e,t,a)=>(e.push(t),a<n.length-1&&e.push(r.cloneElement(s,{key:`separator-${a}`})),e)),[])}const v=e=>{let{ownerState:s,theme:n}=e,r={display:"flex",flexDirection:"column",...(0,p.NI)({theme:n},(0,p.kW)({values:s.direction,breakpoints:n.breakpoints.values}),(e=>({flexDirection:e})))};if(s.spacing){const e=(0,h.LX)(n),t=Object.keys(n.breakpoints.values).reduce(((e,n)=>(("object"===typeof s.spacing&&null!=s.spacing[n]||"object"===typeof s.direction&&null!=s.direction[n])&&(e[n]=!0),e)),{}),i=(0,p.kW)({values:s.direction,base:t}),o=(0,p.kW)({values:s.spacing,base:t});"object"===typeof i&&Object.keys(i).forEach(((e,s,n)=>{if(!i[e]){const r=s>0?i[n[s-1]]:"column";i[e]=r}}));const l=(n,r)=>{return s.useFlexGap?{gap:(0,h._W)(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${t=r?i[r]:s.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[t]}`]:(0,h._W)(e,n)}};var t};r=(0,a.A)(r,(0,p.NI)({theme:n},o,l))}return r=(0,p.iZ)(n.breakpoints,r),r};var g=n(8128),w=n(8301);const k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:s=f,useThemeProps:n=y,componentName:a="MuiStack"}=e,l=s(v),d=r.forwardRef((function(e,s){const r=n(e),d=(0,u.A)(r),{component:c="div",direction:m="column",spacing:p=0,divider:h,children:A,className:f,useFlexGap:y=!1,...v}=d,g={direction:m,spacing:p,useFlexGap:y},w=(0,o.A)({root:["root"]},(e=>(0,i.Ay)(a,e)),{});return(0,x.jsx)(l,{as:c,ownerState:g,ref:s,className:(0,t.A)(w.root,f),...v,children:h?j(A,h):A})}));return d}({createStyledComponent:(0,g.Ay)("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>(0,w.b)({props:e,name:"MuiStack"})}),C=k},5360:(e,s,n)=>{n.r(s),n.d(s,{default:()=>W});var r=n(5043),t=n(2768),a=n(4339),i=n(5895),o=n(2097),l=n(6647),d=n(3969),c=n(172),u=n(1449),m=n(3023),p=n(1911),h=n(8776),x=n(1438),A=n(6154),f=n(5847),y=n(5030),j=n(5877),v=n(2911),g=n(5267),w=n(5362),k=n(1773),C=n(2950),b=n(579);const S=r.forwardRef((function(e,s){return(0,b.jsx)(a.A,{direction:"up",ref:s,...e})})),W=()=>{const[e,s]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[W,z]=(0,r.useState)(""),[N,U]=(0,r.useState)(null),[T,D]=(0,r.useState)({username:"",password:"",isAdmin:!1}),[I,_]=(0,r.useState)({open:!1,message:"",severity:"success"}),[$,M]=(0,r.useState)(!1),[P,R]=(0,r.useState)(!1),[B,E]=(0,r.useState)(null),F=async()=>{a(!0);try{const e=await t.A.get("/users",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`}});s(e.data)}catch(e){z("Failed to fetch users")}a(!1)};(0,r.useEffect)((()=>{F()}),[]);const O=e=>{E(e),R(!0)},G=()=>{U(null),D({username:"",password:"",isAdmin:!1}),M(!0)},q=e=>{U(e._id),D({username:e.username,password:"",isAdmin:e.isAdmin}),M(!0)},H=e=>{const s="checkbox"===e.target.type?e.target.checked:e.target.value;D({...T,[e.target.name]:s})},L=async e=>{e.preventDefault();const s={Authorization:`Bearer ${localStorage.getItem("adminToken")}`};try{if(N){const e={...T};e.password||delete e.password,await t.A.put(`/users/${N}`,e,{headers:s}),_({open:!0,message:"User updated",severity:"success"})}else await t.A.post("/users",T,{headers:s}),_({open:!0,message:"User created",severity:"success"});U(null),D({username:"",password:"",isAdmin:!1}),M(!1),F()}catch{_({open:!0,message:"Save failed",severity:"error"})}},X=()=>{M(!1),U(null),D({username:"",password:"",isAdmin:!1})},Y=[{field:"username",headerName:"Username",flex:1},{field:"isAdmin",headerName:"Admin",flex:1,renderCell:e=>(0,b.jsx)(i.A,{color:e.value?"primary":"text.secondary",children:e.value?"Yes":"No"})},{field:"actions",headerName:"Actions",flex:1,minWidth:160,sortable:!1,renderCell:e=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{variant:"outlined",size:"small",onClick:()=>q(e.row),sx:{mr:1,display:{xs:"none",sm:"inline-flex"}},children:"Edit"}),(0,b.jsx)(o.A,{variant:"outlined",color:"error",size:"small",onClick:()=>O(e.row._id),sx:{display:{xs:"none",sm:"inline-flex"}},children:"Delete"}),(0,b.jsx)(l.A,{size:"small",onClick:()=>q(e.row),sx:{display:{xs:"inline-flex",sm:"none"}},children:(0,b.jsx)(k.A,{})}),(0,b.jsx)(l.A,{size:"small",color:"error",onClick:()=>O(e.row._id),sx:{display:{xs:"inline-flex",sm:"none"}},children:(0,b.jsx)(w.A,{})})]})}];return(0,b.jsxs)(d.A,{children:[(0,b.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,b.jsx)(i.A,{variant:"h5",sx:{fontSize:{xs:"1.4rem",sm:"2rem"},fontWeight:700},children:"Manage Users"}),(0,b.jsx)(o.A,{variant:"contained",startIcon:(0,b.jsx)(C.A,{}),onClick:G,sx:{display:{xs:"none",sm:"flex"}},children:"Add User"}),(0,b.jsx)(l.A,{color:"primary",onClick:G,sx:{display:{xs:"flex",sm:"none"}},children:(0,b.jsx)(C.A,{})})]}),n?(0,b.jsx)(c.A,{}):W?(0,b.jsx)(u.A,{severity:"error",children:W}):(0,b.jsx)(d.A,{sx:{width:"100%",maxWidth:"100vw",overflowX:"auto"},children:(0,b.jsx)(g.z,{autoHeight:!0,rows:e.map((e=>({...e,id:e._id}))),columns:Y,pageSize:10,rowsPerPageOptions:[5,10,20,100],sx:{minWidth:320,maxWidth:"100vw",bgcolor:"background.paper",color:"text.primary",borderRadius:2},disableSelectionOnClick:!0})}),(0,b.jsxs)(m.A,{open:$,onClose:X,maxWidth:"sm",fullWidth:!0,TransitionComponent:S,children:[(0,b.jsx)(p.A,{children:N?"Edit User":"Add New User"}),(0,b.jsx)(h.A,{dividers:!0,children:(0,b.jsx)("form",{onSubmit:L,style:{width:"100%"},children:(0,b.jsxs)(x.A,{spacing:2,sx:{mt:1},children:[(0,b.jsx)(A.A,{name:"username",label:"Username",value:T.username,onChange:H,required:!0,size:"small",variant:"outlined",fullWidth:!0}),(0,b.jsx)(A.A,{name:"password",label:N?"New Password (leave blank to keep current)":"Password",type:"password",value:T.password,onChange:H,required:!N,size:"small",variant:"outlined",fullWidth:!0}),(0,b.jsx)(f.A,{control:(0,b.jsx)(y.A,{checked:T.isAdmin,onChange:H,name:"isAdmin"}),label:"Admin User"})]})})}),(0,b.jsxs)(j.A,{children:[(0,b.jsx)(o.A,{onClick:X,children:"Cancel"}),(0,b.jsx)(o.A,{onClick:L,variant:"contained",disabled:!T.username||!N&&!T.password,children:N?"Update":"Create"})]})]}),(0,b.jsxs)(m.A,{open:P,onClose:()=>R(!1),TransitionComponent:S,children:[(0,b.jsx)(p.A,{children:"Confirm Delete"}),(0,b.jsx)(h.A,{dividers:!0,children:"Are you sure you want to delete this user?"}),(0,b.jsxs)(j.A,{children:[(0,b.jsx)(o.A,{onClick:()=>R(!1),children:"Cancel"}),(0,b.jsx)(o.A,{onClick:async()=>{if(B){try{await t.A.delete(`/users/${B}`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`}}),_({open:!0,message:"User deleted",severity:"success"}),F()}catch{_({open:!0,message:"Delete failed",severity:"error"})}R(!1),E(null)}},color:"error",variant:"contained",children:"Delete"})]})]}),(0,b.jsx)(v.A,{open:I.open,autoHideDuration:3e3,onClose:()=>_({...I,open:!1}),children:(0,b.jsx)(u.A,{onClose:()=>_({...I,open:!1}),severity:I.severity,sx:{width:"100%"},children:I.message})})]})}}}]);
//# sourceMappingURL=360.6a7c4244.chunk.js.map