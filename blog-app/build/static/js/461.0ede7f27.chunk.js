"use strict";(self.webpackChunkblog_app=self.webpackChunkblog_app||[]).push([[461],{5461:(e,s,n)=>{n.r(s),n.d(s,{default:()=>k});var i=n(5043),t=n(2768),a=n(4339),l=n(2097),r=n(6647),o=n(3969),d=n(5895),c=n(172),x=n(1449),m=n(3023),h=n(1911),p=n(8776),u=n(6154),y=n(5877),A=n(2911),j=n(5267),f=n(5362),g=n(1773),v=n(2950),C=n(579);const w=i.forwardRef((function(e,s){return(0,C.jsx)(a.A,{direction:"up",ref:s,...e})})),k=()=>{const[e,s]=(0,i.useState)([]),[n,a]=(0,i.useState)(!0),[k,S]=(0,i.useState)(""),[b,T]=(0,i.useState)(null),[z,W]=(0,i.useState)({name:""}),[D,_]=(0,i.useState)({open:!1,message:"",severity:"success"}),[I,N]=(0,i.useState)(!1),[$,E]=(0,i.useState)(!1),[B,F]=(0,i.useState)(null),H=async()=>{a(!0);try{const e=await t.A.get("/types");s(e.data)}catch(e){S("Failed to fetch types")}a(!1)};(0,i.useEffect)((()=>{H()}),[]);const O=e=>{F(e),E(!0)},P=()=>{T(null),W({name:""}),N(!0)},R=e=>{T(e._id),W({name:e.name}),N(!0)},q=async e=>{e.preventDefault();const s={Authorization:`Bearer ${localStorage.getItem("adminToken")}`};try{b?(await t.A.put(`/types/${b}`,z,{headers:s}),_({open:!0,message:"Type updated",severity:"success"})):(await t.A.post("/types",z,{headers:s}),_({open:!0,message:"Type created",severity:"success"})),T(null),W({name:""}),N(!1),H()}catch{_({open:!0,message:"Save failed",severity:"error"})}},M=()=>{N(!1),T(null),W({name:""})},U=[{field:"name",headerName:"Name",flex:1},{field:"actions",headerName:"Actions",flex:1,minWidth:160,sortable:!1,renderCell:e=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(l.A,{variant:"outlined",size:"small",onClick:()=>R(e.row),sx:{mr:1,display:{xs:"none",sm:"inline-flex"}},children:"Edit"}),(0,C.jsx)(l.A,{variant:"outlined",color:"error",size:"small",onClick:()=>O(e.row._id),sx:{display:{xs:"none",sm:"inline-flex"}},children:"Delete"}),(0,C.jsx)(r.A,{size:"small",onClick:()=>R(e.row),sx:{display:{xs:"inline-flex",sm:"none"}},children:(0,C.jsx)(g.A,{})}),(0,C.jsx)(r.A,{size:"small",color:"error",onClick:()=>O(e.row._id),sx:{display:{xs:"inline-flex",sm:"none"}},children:(0,C.jsx)(f.A,{})})]})}];return(0,C.jsxs)(o.A,{children:[(0,C.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,C.jsx)(d.A,{variant:"h5",sx:{fontSize:{xs:"1.4rem",sm:"2rem"},fontWeight:700},children:"Manage Types"}),(0,C.jsx)(l.A,{variant:"contained",startIcon:(0,C.jsx)(v.A,{}),onClick:P,sx:{display:{xs:"none",sm:"flex"}},children:"Add Type"}),(0,C.jsx)(r.A,{color:"primary",onClick:P,sx:{display:{xs:"flex",sm:"none"}},children:(0,C.jsx)(v.A,{})})]}),n?(0,C.jsx)(c.A,{}):k?(0,C.jsx)(x.A,{severity:"error",children:k}):(0,C.jsx)(o.A,{sx:{width:"100%",maxWidth:"100vw",overflowX:"auto"},children:(0,C.jsx)(j.z,{autoHeight:!0,rows:e.map((e=>({...e,id:e._id}))),columns:U,pageSize:10,rowsPerPageOptions:[5,10,20,100],sx:{minWidth:320,maxWidth:"100vw",bgcolor:"background.paper",color:"text.primary",borderRadius:2},disableSelectionOnClick:!0})}),(0,C.jsxs)(m.A,{open:I,onClose:M,maxWidth:"sm",fullWidth:!0,TransitionComponent:w,children:[(0,C.jsx)(h.A,{children:b?"Edit Type":"Add New Type"}),(0,C.jsx)(p.A,{dividers:!0,children:(0,C.jsx)("form",{onSubmit:q,style:{width:"100%"},children:(0,C.jsx)(u.A,{name:"name",label:"Type name",value:z.name,onChange:e=>{W({...z,[e.target.name]:e.target.value})},required:!0,size:"small",variant:"outlined",fullWidth:!0,sx:{mt:1}})})}),(0,C.jsxs)(y.A,{children:[(0,C.jsx)(l.A,{onClick:M,children:"Cancel"}),(0,C.jsx)(l.A,{onClick:q,variant:"contained",disabled:!z.name,children:b?"Update":"Create"})]})]}),(0,C.jsxs)(m.A,{open:$,onClose:()=>E(!1),TransitionComponent:w,children:[(0,C.jsx)(h.A,{children:"Confirm Delete"}),(0,C.jsx)(p.A,{dividers:!0,children:"Are you sure you want to delete this type?"}),(0,C.jsxs)(y.A,{children:[(0,C.jsx)(l.A,{onClick:()=>E(!1),children:"Cancel"}),(0,C.jsx)(l.A,{onClick:async()=>{if(B){try{await t.A.delete(`/types/${B}`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`}}),_({open:!0,message:"Type deleted",severity:"success"}),H()}catch{_({open:!0,message:"Delete failed",severity:"error"})}E(!1),F(null)}},color:"error",variant:"contained",children:"Delete"})]})]}),(0,C.jsx)(A.A,{open:D.open,autoHideDuration:3e3,onClose:()=>_({...D,open:!1}),children:(0,C.jsx)(x.A,{onClose:()=>_({...D,open:!1}),severity:D.severity,sx:{width:"100%"},children:D.message})})]})}}}]);
//# sourceMappingURL=461.0ede7f27.chunk.js.map